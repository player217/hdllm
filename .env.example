# HD현대미포 Gauss-1 RAG System - Enhanced Environment Configuration Template
# Version: 3.0 - Portable & Smart Deployment Ready
# ====================================================================
# 이 파일을 .env로 복사하여 사용하세요 / Copy this file to .env to use
# 
# 새로운 기능 / New Features in v3.0:
# - Smart Qdrant mode switching (auto/local/remote)
# - Portable binary support with auto-download
# - Path-independent deployment
# - Enhanced security and performance settings
# ====================================================================

# ============================================================
# 1. CORE APPLICATION SETTINGS (핵심 애플리케이션 설정)
# ============================================================

# Service Ports (서비스 포트)
APP_PORT=8080
FRONTEND_PORT=8001
GUI_AUTO_START=false

# Application Mode (애플리케이션 모드)
# Options: development | testing | production
ENV_MODE=development

# System Encoding (시스템 인코딩)
PYTHONIOENCODING=utf-8

# ============================================================
# 2. SMART QDRANT CONFIGURATION (스마트 Qdrant 설정)
# ============================================================

# Qdrant Connection Mode (Qdrant 연결 모드)
# auto: 자동 (원격 우선, 실패 시 로컬)
# local: 강제 로컬 실행
# remote: 강제 원격 연결
QDRANT_MODE=auto

# Remote Qdrant Server (원격 Qdrant 서버)
# 부서 공용 서버 정보
REMOTE_QDRANT_HOST=10.150.104.37
REMOTE_QDRANT_PORT=6333

# Local Qdrant Settings (로컬 Qdrant 설정)
LOCAL_QDRANT_PORT=6333
LOCAL_QDRANT_STORAGE=./data/qdrant

# Connection Testing (연결 테스트)
CONNECTION_TIMEOUT=5
RETRY_ATTEMPTS=3
RETRY_DELAY=2

# Legacy Compatibility (레거시 호환성)
# 기존 코드와의 호환성을 위해 자동 설정됨 (run.bat에서 동적 설정)
RAG_MAIL_QDRANT_HOST=127.0.0.1
RAG_MAIL_QDRANT_PORT=6333
RAG_DOC_QDRANT_HOST=127.0.0.1
RAG_DOC_QDRANT_PORT=6333

# ============================================================
# 3. OLLAMA LLM CONFIGURATION (Ollama LLM 설정)
# ============================================================

# Ollama Service Settings (Ollama 서비스 설정)
OLLAMA_HOST=127.0.0.1
OLLAMA_PORT=11434
OLLAMA_ENDPOINT=http://127.0.0.1:11434

# Model Configuration (모델 설정)
OLLAMA_AUTO_PULL=true
OLLAMA_MODEL=gemma3:4b
# Alternative models: llama3.2:3b, mistral:7b, qwen2.5:7b

# LLM Generation Parameters (LLM 생성 파라미터)
LLM_TEMPERATURE=0.7
LLM_MAX_TOKENS=2048
LLM_TOP_P=0.9
LLM_TOP_K=40
LLM_REPEAT_PENALTY=1.1

# Streaming Settings (스트리밍 설정)
LLM_STREAM_ENABLED=true
LLM_STREAM_CHUNK_SIZE=8192
LLM_STREAM_TIMEOUT=60

# ============================================================
# 4. DATA PATHS (데이터 경로 설정)
# ============================================================

# Primary Data Directories (주요 데이터 디렉토리)
# 상대 경로 사용으로 포터블 배포 지원
MAIL_QDRANT_PATH=./data/qdrant/mail
DOC_QDRANT_PATH=./data/qdrant/doc
LOCAL_MSG_PATH=./data/messages
MODEL_PATH=./data/models

# Storage Paths (저장소 경로)
DATA_PATH=./data
STORAGE_PATH=./storage
LOG_PATH=./logs
TEMP_PATH=./temp
BACKUP_PATH=./backups

# ============================================================
# 5. PORTABLE BINARY PATHS (포터블 바이너리 경로)
# ============================================================

# Python Embedded (Python 임베디드)
# 시스템 Python이 없을 경우 자동 다운로드됨
PORTABLE_PYTHON_PATH=./bin/python311/python.exe

# Qdrant Binary (Qdrant 바이너리)
# 로컬 모드 사용 시 자동 다운로드됨
PORTABLE_QDRANT_PATH=./bin/qdrant/qdrant.exe

# Ollama Binary (Ollama 바이너리)
# 시스템 설치가 없을 경우 포터블 버전 사용
PORTABLE_OLLAMA_PATH=./bin/ollama/ollama.exe

# ============================================================
# 6. EMBEDDING CONFIGURATION (임베딩 설정)
# ============================================================

# Embedding Model (임베딩 모델)
# Local path or HuggingFace model ID
EMBED_MODEL=./src/bin/bge-m3-local
# Alternative: EMBED_MODEL=BAAI/bge-m3

# Embedding Backend (임베딩 백엔드)
# Options: st (sentence_transformers) | ollama | openai
EMBED_BACKEND=st

# Device Configuration (디바이스 설정)
# Options: cpu | cuda | cuda:0 | mps (Mac M1/M2)
EMBED_DEVICE=cpu

# Embedding Parameters (임베딩 파라미터)
EMBED_DIMENSION=1024
EMBED_BATCH_SIZE=32
EMBED_MAX_LENGTH=512
NORMALIZE_EMBEDDINGS=true

# Embedding Cache (임베딩 캐시)
EMBED_CACHE_ENABLED=true
EMBED_CACHE_MAX=512
EMBED_CACHE_TTL=3600

# ============================================================
# 7. API & SECURITY SETTINGS (API 및 보안 설정)
# ============================================================

# CORS Configuration (CORS 설정)
ALLOWED_ORIGINS=http://localhost:8001,http://127.0.0.1:8001,http://localhost:8080,http://127.0.0.1:8080

# API Security (API 보안)
API_KEY_ENABLED=false
# API_KEY=your-secure-api-key-here  # 활성화 시 설정

# Rate Limiting (속도 제한)
RATE_LIMIT_ENABLED=true
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_PER_HOUR=1000

# Request Validation (요청 검증)
MAX_QUESTION_LENGTH=2000
MAX_CONTEXT_LENGTH=10000
ENABLE_INPUT_SANITIZATION=true

# PII Protection (개인정보 보호)
PII_MASKING_ENABLED=true
PII_PATTERNS_FILE=./config/pii_patterns.json

# ============================================================
# 8. PERFORMANCE OPTIMIZATION (성능 최적화)
# ============================================================

# Cache Configuration (캐시 설정)
CACHE_BACKEND=memory
CACHE_SIZE_MB=500

# Vector Search Optimization (벡터 검색 최적화)
QDRANT_HNSW_EF=128
QDRANT_EXACT=false
QDRANT_SEARCH_LIMIT=10
QDRANT_SCORE_THRESHOLD=0.3

# Parallel Processing (병렬 처리)
MAX_WORKERS=4
ASYNC_WORKERS=2
WORKER_COUNT=0  # 0: 자동 감지

# Memory Management (메모리 관리)
MAX_MEMORY_MB=4096
ENABLE_MEMORY_PROFILING=false

# ============================================================
# 9. LOGGING & MONITORING (로깅 및 모니터링)
# ============================================================

# Logging Configuration (로깅 설정)
LOG_LEVEL=INFO
LOG_FORMAT=json
LOG_FILE_ENABLED=true
LOG_FILE_PATH=./logs/app.log
LOG_FILE_MAX_SIZE=10485760  # 10MB
LOG_FILE_BACKUP_COUNT=5

# Security Logging (보안 로깅)
LOG_REDACT_PII=true
SECURITY_AUDIT_ENABLED=true
SECURITY_LOG_FILE=./logs/security.log

# Metrics Collection (메트릭 수집)
METRICS_ENABLED=true
METRICS_NAMESPACE=hdllm
METRICS_EXPORT_INTERVAL=60

# Health Check (헬스 체크)
HEALTH_CHECK_INTERVAL=30
HEALTH_CHECK_TIMEOUT=5

# ============================================================
# 10. NOTIFICATION SETTINGS (알림 설정)
# ============================================================

# System Tray (시스템 트레이)
MINIMIZE_TO_TRAY=true
START_MINIMIZED=false
NOTIFICATIONS_ENABLED=true

# Status Notifications (상태 알림)
QDRANT_FALLBACK_NOTIFY=true
SERVICE_STATUS_NOTIFY=true

# ============================================================
# 11. BACKUP & RECOVERY (백업 및 복구)
# ============================================================

# Automatic Backup (자동 백업)
AUTO_BACKUP=false
BACKUP_INTERVAL_HOURS=24
BACKUP_RETENTION_DAYS=7

# Recovery Settings (복구 설정)
RECOVERY_ENABLED=true
RECOVERY_CHECK_INTERVAL=3600

# ============================================================
# 12. DEVELOPMENT & DEBUG (개발 및 디버그)
# ============================================================

# Debug Mode (디버그 모드)
DEBUG_MODE=false
DEBUG_SQL=false
DEBUG_EMBEDDINGS=false
DEBUG_LLM=false

# Development Server (개발 서버)
DEV_SERVER_HOST=0.0.0.0
DEV_SERVER_PORT=8080
DEV_SERVER_RELOAD=true
DEV_SERVER_WORKERS=1

# Testing Configuration (테스트 설정)
TEST_MODE=false
USE_TEST_DATA=false

# ============================================================
# 13. NETWORK SETTINGS (네트워크 설정)
# ============================================================

# Connection Settings (연결 설정)
MAX_CONNECTIONS=100
REQUEST_TIMEOUT=30

# Proxy Settings (프록시 설정)
# HTTP_PROXY=http://proxy.company.com:8080
# HTTPS_PROXY=http://proxy.company.com:8080
# NO_PROXY=localhost,127.0.0.1

# DNS Settings (DNS 설정)
DNS_TIMEOUT=5
DNS_RETRIES=3

# ============================================================
# 14. SECURITY ENHANCEMENT (보안 강화)
# ============================================================

# Encryption (암호화)
# ENCRYPTION_KEY=your-encryption-key-here  # 프로덕션에서 설정

# JWT Configuration (JWT 설정)
# JWT_SECRET_KEY=your-jwt-secret-key-here  # 프로덕션에서 설정
# JWT_EXPIRATION_HOURS=24

# Session Management (세션 관리)
SESSION_TIMEOUT_MINUTES=60
MAX_CONCURRENT_SESSIONS=5

# ============================================================
# 15. NAMESPACE CONFIGURATION (네임스페이스 설정)
# ============================================================

# Collection Naming (컬렉션 명명)
NAMESPACE_PATTERN={scope}_{env}_{source}_my_documents
QDRANT_NAMESPACE=hdllm
QDRANT_ENV=dev

# Compatibility Mode (호환성 모드)
NAMESPACE_COMPAT_ENABLED=true
NAMESPACE_COMPAT_FALLBACK=mail_my_documents,doc_my_documents,my_documents

# Migration Settings (마이그레이션 설정)
AUTO_MIGRATE_COLLECTIONS=false
MIGRATION_BATCH_SIZE=100

# ============================================================
# END OF CONFIGURATION
# ============================================================
# 
# 사용 방법 / Usage:
# 1. scripts/install.ps1 실행으로 자동 설치 (권장)
# 2. 이 파일을 .env로 복사 / Copy this file to .env
# 3. 필요한 값 수정 / Modify values as needed
# 4. scripts/run.bat 실행 / Run scripts/run.bat
#
# 새로운 기능 / New Features:
# - 스마트 Qdrant 모드 (auto/local/remote)
# - 포터블 바이너리 자동 다운로드
# - 경로 무관 배포 지원
# - 향상된 보안 및 성능 설정
#
# 보안 주의사항 / Security Notes:
# - .env 파일을 Git에 커밋하지 마세요 / Never commit .env to Git
# - 프로덕션 환경에서는 적절한 보안 설정 적용 / Apply proper security settings in production
# - API 키와 비밀번호는 안전하게 관리하세요 / Keep API keys secure
#
# 지원 / Support:
# HD현대미포 선각기술부 / HD Hyundai Mipo Advanced Technology Dept.
# ============================================================